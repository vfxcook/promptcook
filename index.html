<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Mockup Prompt Generator</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js"></script>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">

    <h1 class="text-center text-3xl font-bold mt-6 text-blue-600">AI Mockup Prompt Generator</h1>

    <div class="max-w-4xl mx-auto mt-6">
        <div id="promptContainer"></div>
    </div>

    <script>
        // âœ… Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDQz9IloW02h5fyBe8onrnQ45kAK8YT2eU",
            authDomain: "promptcook.firebaseapp.com",
            projectId: "promptcook",
            storageBucket: "promptcook.appspot.com",
            messagingSenderId: "629727878561",
            appId: "1:629727878561:web:a20882f86dad45e7a6bfe0"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function fetchPrompts() {
            db.collection("prompts").get().then(snapshot => {
                snapshot.forEach(doc => {
                    let data = doc.data();
                    renderPromptCard(doc.id, data.prompt, data.tags);
                });
            });
        }

        function renderPromptCard(id, prompt, tags) {
            let container = document.getElementById("promptContainer");
            let card = document.createElement("div");
            card.className = "prompt-card bg-white p-6 rounded-lg shadow-lg mt-4";
            
            let inputsHTML = "";
            let updatedPrompt = prompt;

            tags.forEach(tag => {
                let regex = new RegExp(`<${tag}>(.*?)<\/${tag}>`, "g");
                let match = regex.exec(prompt);
                let defaultValue = match ? match[1] : "";

                inputsHTML += `
                    <label class="block font-semibold text-gray-600 mt-2">${tag.charAt(0).toUpperCase() + tag.slice(1)}</label>
                    <input type="text" data-tag="${tag}" value="${defaultValue}" 
                        oninput="updatePrompt('${id}', this)"
                        class="w-full p-2 border rounded-lg mt-1">
                `;
            });

            card.innerHTML = `
                <p id="prompt-${id}" class="text-gray-800 text-lg mb-4">${updatedPrompt}</p>
                ${inputsHTML}
                <button onclick="copyToClipboard('${id}')" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg">
                    Copy Prompt
                </button>
            `;
            container.appendChild(card);
        }

        function updatePrompt(id, input) {
            let tag = input.getAttribute("data-tag");
            let newValue = input.value || `<${tag}>`; 
            let promptText = document.getElementById(`prompt-${id}`).innerText;

            let regex = new RegExp(`<${tag}>(.*?)<\/${tag}>`, "g");
            let updatedText = promptText.replace(regex, `<${tag}>${newValue}</${tag}>`);

            document.getElementById(`prompt-${id}`).innerText = updatedText;
        }

        function copyToClipboard(id) {
            let text = document.getElementById(`prompt-${id}`).innerText;
            navigator.clipboard.writeText(text);
            alert("Copied to clipboard!");
        }

        fetchPrompts();
    </script>

</body>
</html>
